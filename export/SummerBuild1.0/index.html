<!DOCTYPE html>
<html lang="en-us" style="width: 100%; height: 100%;">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>ZombieLand Character Editor</title>
</head>
<body style="text-align: center; padding: 0; border: 0; margin: 0; width: 100%; height: 100%;">
  <div id="loadingSpinner" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 24px;">
    <div class="spinner"></div>
    Загрузка...
  </div>
  <canvas id="unity-canvas" style="width: 100%; height: 100%; background: #231F20;"></canvas>
  <div id="orientationMessage" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 24px;">Поверните устройство/rotate device</div>
  
  <button id="fullscreenButton" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: none; background: transparent; border: none;"> </button>

  <style>
    .spinner {
      margin: 0 auto;
      width: 40px;
      height: 40px;
      position: relative;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top: 4px solid #ffffff;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>

  <script src="Build/SummerBuild1.0.loader.js"></script>
  <script>
    var canvas = document.querySelector("#unity-canvas");
    var fullscreenButton = document.querySelector("#fullscreenButton");
    var loadingSpinner = document.querySelector("#loadingSpinner");
    var unityInstance = null;

    function checkOrientation() {
      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        if (window.innerHeight > window.innerWidth) {
          // Vertical orientation detected
          canvas.style.display = "none";
          document.querySelector("#orientationMessage").style.display = "block";
          fullscreenButton.style.display = "none";
        } else {
          // Horizontal orientation
          canvas.style.display = "block";
          document.querySelector("#orientationMessage").style.display = "none";
          fullscreenButton.style.display = "block";
        }
      } else {
        document.querySelector("#orientationMessage").style.display = "none";
        fullscreenButton.style.display = "none";
      }
    }

    function toggleFullscreen() {
      if (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement) {
        // Exit fullscreen
        if (document.exitFullscreen) {
          document.exitFullscreen();
        } else if (document.webkitExitFullscreen) {
          document.webkitExitFullscreen();
        } else if (document.mozCancelFullScreen) {
          document.mozCancelFullScreen();
        } else if (document.msExitFullscreen) {
          document.msExitFullscreen();
        }
      } else {
        // Enter fullscreen
        if (canvas.requestFullscreen) {
          canvas.requestFullscreen();
        } else if (canvas.webkitRequestFullscreen) {
          canvas.webkitRequestFullscreen();
        } else if (canvas.mozRequestFullScreen) {
          canvas.mozRequestFullScreen();
        } else if (canvas.msRequestFullscreen) {
          canvas.msRequestFullscreen();
        }
      }
    }

    function showLoadingSpinner() {
      loadingSpinner.style.display = "block";
      canvas.style.display = "none";
    }

    function hideLoadingSpinner() {
      loadingSpinner.style.display = "none";
      canvas.style.display = "block";
    }

    function onUnityLoaded() {
      // Показываем контент Unity и скрываем спиннер загрузки после полной загрузки игры
      hideLoadingSpinner();
      canvas.style.display = "block";
    }

    function unityProgress(unityInstance, progress) {
      // Этот обратный вызов будет вызван во время загрузки Unity
      if (progress >= 1) {
        onUnityLoaded();
      }
    }

    window.addEventListener("resize", checkOrientation);
    checkOrientation();

    fullscreenButton.addEventListener("click", toggleFullscreen);

    unityInstance = UnityLoader.instantiate("unity-canvas", "Build/SummerBuild1.0.json", {
      onProgress: unityProgress
    });
  </script>
</body>
</html>
